(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf72a650"],{"00f9":function(t,i,e){"use strict";var a=e("7940"),o=e.n(a);o.a},1432:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"detail-title-wrapper",class:{"hide-shadow":t.ifHideShadow}},[e("div",{staticClass:"title-left-wrapper",on:{click:t.back}},[e("span",{staticClass:"icon-back"})]),e("div",{staticClass:"title-right-wrapper"}),t.title?e("div",{staticClass:"title-text"},[t._v("\n    "+t._s(t.title)+"\n  ")]):t._e()])},o=[],s={props:{title:String,showShelf:{type:Boolean,default:!0}},data:function(){return{ifHideShadow:!0}},methods:{showBookShelf:function(){this.$router.push("/store/shelf")},showShadow:function(){this.ifHideShadow=!1},hideShadow:function(){this.ifHideShadow=!0},back:function(){this.$emit("back")}}},n=s,r=(e("83ad"),e("2877")),c=Object(r["a"])(n,a,o,!1,null,"11715636",null);i["a"]=c.exports},"29a3":function(t,i,e){"use strict";var a=e("4563"),o=e.n(a);o.a},"31e5":function(t,i,e){},"3b2b":function(t,i,e){var a=e("7726"),o=e("5dbc"),s=e("86cc").f,n=e("9093").f,r=e("aae3"),c=e("0bfb"),l=a.RegExp,d=l,u=l.prototype,h=/a/g,f=/a/g,v=new l(h)!==h;if(e("9e1e")&&(!v||e("79e5")(function(){return f[e("2b4c")("match")]=!1,l(h)!=h||l(f)==f||"/a/i"!=l(h,"i")}))){l=function(t,i){var e=this instanceof l,a=r(t),s=void 0===i;return!e&&a&&t.constructor===l&&s?t:o(v?new d(a&&!s?t.source:t,i):d((a=t instanceof l)?t.source:t,a&&s?c.call(t):i),e?this:u,l)};for(var p=function(t){t in l||s(l,t,{configurable:!0,get:function(){return d[t]},set:function(i){d[t]=i}})},b=n(d),g=0;b.length>g;)p(b[g++]);u.constructor=l,l.prototype=u,e("2aba")(a,"RegExp",l)}e("7a56")("RegExp")},4563:function(t,i,e){},5147:function(t,i,e){var a=e("2b4c")("match");t.exports=function(t){var i=/./;try{"/./"[t](i)}catch(e){try{return i[a]=!1,!"/./"[t](i)}catch(o){}}return!0}},"5bab":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"book-detail"},[e("detail-title",{ref:"title",attrs:{showShelf:!0},on:{back:t.back}}),e("scroll",{ref:"scroll",staticClass:"content-wrapper",attrs:{top:42,bottom:52},on:{onScroll:t.onScroll}},[e("book-info",{attrs:{cover:t.cover,title:t.title,author:t.author,desc:t.desc}}),e("div",{staticClass:"book-detail-content-wrapper"},[e("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.copyright")))]),e("div",{staticClass:"book-detail-content-list-wrapper"},[e("div",{staticClass:"book-detail-content-row"},[e("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.publisher")))]),e("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.publisher))])]),e("div",{staticClass:"book-detail-content-row"},[e("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.category")))]),e("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.categoryText))])]),e("div",{staticClass:"book-detail-content-row"},[e("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.lang")))]),e("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.lang))])]),e("div",{staticClass:"book-detail-content-row"},[e("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.ISBN")))]),e("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.isbn))])])])]),e("div",{staticClass:"book-detail-content-wrapper"},[e("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.navigation")))]),e("div",{staticClass:"book-detail-content-list-wrapper"},[this.navigation?t._e():e("div",{staticClass:"loading-text-wrapper"},[e("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])]),e("div",{staticClass:"book-detail-content-item-wrapper"},t._l(t.flatNavigation,function(i,a){return e("div",{key:a,staticClass:"book-detail-content-item",on:{click:function(e){return t.read(i)}}},[i.label?e("div",{staticClass:"book-detail-content-navigation-text",class:{"is-sub":i.deep>1},style:t.itemStyle(i)},[t._v(t._s(i.label)+"\n            ")]):t._e()])}),0)])]),e("div",{staticClass:"book-detail-content-wrapper"},[e("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.trial")))]),e("div",{staticClass:"book-detail-content-list-wrapper"},[this.displayed?t._e():e("div",{staticClass:"loading-text-wrapper"},[e("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:this.displayed,expression:"this.displayed"}],ref:"preview",attrs:{id:"preview"}})])],1),e("div",{staticClass:"bottom-wrapper"},[e("div",{staticClass:"bottom-btn",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.readBook()}}},[t._v(t._s(t.$t("detail.read")))])]),e("toast",{ref:"toast",attrs:{text:t.toastText}})],1)},o=[],s=e("70e8"),n=s["a"],r=(e("00f9"),e("2877")),c=Object(r["a"])(n,a,o,!1,null,"3e61f106",null);i["default"]=c.exports},"6f51":function(t,i,e){},"70e8":function(t,i,e){"use strict";(function(t){e("f559"),e("a481"),e("3b2b"),e("ac6a");var a=e("75fc"),o=e("1432"),s=e("c470"),n=e("6701"),r=e("78dc"),c=e("73f5"),l=e("fa7d"),d=e("bb38");t.ePub=d["a"],i["a"]={components:{DetailTitle:o["a"],Scroll:n["a"],BookInfo:s["a"],Toast:r["a"]},computed:{desc:function(){return this.description?this.description.substring(0,100):""},flatNavigation:function(){return this.navigation?Array.prototype.concat.apply([],Array.prototype.concat.apply([],this.doFlatNavigation(this.navigation.toc))):[]},lang:function(){return this.metadata?this.metadata.language:"-"},isbn:function(){return this.metadata?this.metadata.identifier:"-"},publisher:function(){return this.metadata?this.metadata.publisher:"-"},title:function(){return this.metadata?this.metadata.title:""},author:function(){return this.metadata?this.metadata.creator:""},inBookShelf:function(){var t=this;if(this.bookItem&&this.bookShelf){var i=function t(i){var e;return(e=[]).concat.apply(e,Object(a["a"])(i.map(function(i){return i.itemList?[i].concat(Object(a["a"])(t(i.itemList))):i})))}(this.bookShelf).filter(function(t){return 1===t.type}),e=i.filter(function(i){return i.fileName===t.bookItem.fileName});return e&&e.length>0}return!1}},data:function(){return{bookItem:null,book:null,metadata:null,trialRead:null,cover:null,navigation:null,displayed:!1,audio:null,randomLocation:null,description:null,toastText:"",trialText:null,categoryText:null,opf:null}},methods:{addOrRemoveShelf:function(){},showToast:function(t){this.toastText=t,this.$refs.toast.show()},readBook:function(){console.log("阅读"),this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},trialListening:function(){},read:function(t){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},itemStyle:function(t){return{marginLeft:(t.deep-1)*Object(l["a"])(20)+"rem"}},doFlatNavigation:function(t){var i=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=[];return t.forEach(function(t){t.deep=e,a.push(t),t.subitems&&t.subitems.length>0&&a.push(i.doFlatNavigation(t.subitems,e+1))}),a},downloadBook:function(){var t="".concat("http://47.99.166.157/epub","/").concat(this.bookItem.categoryText,"/").concat(this.bookItem.fileName,"/OEBPS/package.opf");this.parseBook(t)},parseBook:function(t){var i=this;this.book=new d["a"](t),this.book.loaded.metadata.then(function(t){i.metadata=t}),this.book.loaded.navigation.then(function(t){if(i.navigation=t,i.navigation.toc&&i.navigation.toc.length>1){var e=i.display(i.navigation.toc[1].href);e&&e.then(function(t){i.$refs.scroll&&i.$refs.scroll.refresh(),i.displayed=!0;var e=new RegExp("<.+?>","g"),a=t.output.replace(e,"").replace(/\s\s/g,"");i.description=a})}})},init:function(){var t=this;this.fileName=this.$route.query.fileName,this.categoryText=this.$route.query.category,this.fileName&&Object(c["a"])({fileName:this.fileName}).then(function(i){if(200===i.status&&0===i.data.error_code&&i.data.data){var e=i.data.data;t.bookItem=e,t.cover=t.bookItem.cover;var a=e.rootFile;a.startsWith("/")&&(a=a.substring(1,a.length)),t.opf="".concat("http://47.99.166.157/epub2","/").concat(t.fileName,"/").concat(a),t.parseBook(t.opf)}else t.showToast(i.data.msg)})},back:function(){this.$router.go(-1)},display:function(t){if(this.$refs.preview)return this.rendition||(this.rendition=this.book.renderTo("preview",{width:window.innerWidth>640?640:window.innerWidth,height:window.innerHeight,method:"default"})),t?this.rendition.display(t):this.rendition.display()},onScroll:function(t){t>Object(l["b"])(42)?this.$refs.title.showShadow():this.$refs.title.hideShadow()}},mounted:function(){this.init()}}}).call(this,e("c8ba"))},"78dc":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"toast-bg"},[e("div",{staticClass:"toast-wrapper"},[e("div",{staticClass:"toast",domProps:{innerHTML:t._s(t.text)}})])])])},o=[],s=(e("c5f6"),{props:{text:[String,Number],timeout:{type:Number,default:1500}},data:function(){return{visible:!1}},methods:{hide:function(){this.visible=!1},show:function(){var t=this;clearTimeout(this.task),this.task=null,this.visible=!0,this.task=setTimeout(function(){t.visible=!1},this.timeout)},continueShow:function(){clearTimeout(this.task),this.task=null,this.visible=!0}}}),n=s,r=(e("29a3"),e("2877")),c=Object(r["a"])(n,a,o,!1,null,"1c63128c",null);i["a"]=c.exports},7940:function(t,i,e){},"83ad":function(t,i,e){"use strict";var a=e("6f51"),o=e.n(a);o.a},bf02:function(t,i,e){"use strict";var a=e("31e5"),o=e.n(a);o.a},c470:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"cover-title-wrapper"},[e("div",{staticClass:"cover-title-left-wrapper"},[e("img",{staticClass:"cover-img",attrs:{src:t.cover}})]),e("div",{staticClass:"cover-title-right-wrapper"},[e("div",{staticClass:"detail-cover-title-wrapper"},[e("div",{staticClass:"cover-title-text"},[t._v(t._s(t.title))])]),e("div",{staticClass:"cover-author-wrapper"},[e("div",{staticClass:"cover-author-text"},[t._v(t._s(t.author))])]),e("div",{staticClass:"detail-cover-description-wrapper"},[e("div",{staticClass:"detail-cover-description-text"},[t._v(t._s(t.desc))])])])])},o=[],s={props:{cover:String,title:String,author:String,desc:String}},n=s,r=(e("bf02"),e("2877")),c=Object(r["a"])(n,a,o,!1,null,"21df8ef4",null);i["a"]=c.exports},d2c8:function(t,i,e){var a=e("aae3"),o=e("be13");t.exports=function(t,i,e){if(a(i))throw TypeError("String#"+e+" doesn't accept regex!");return String(o(t))}},f559:function(t,i,e){"use strict";var a=e("5ca1"),o=e("9def"),s=e("d2c8"),n="startsWith",r=""[n];a(a.P+a.F*e("5147")(n),"String",{startsWith:function(t){var i=s(this,t,n),e=o(Math.min(arguments.length>1?arguments[1]:void 0,i.length)),a=String(t);return r?r.call(i,a,e):i.slice(e,e+a.length)===a}})}}]);
//# sourceMappingURL=chunk-bf72a650.2e97611f.js.map